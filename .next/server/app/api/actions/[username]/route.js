"use strict";(()=>{var e={};e.id=206,e.ids=[206],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},524:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},2361:e=>{e.exports=require("events")},7147:e=>{e.exports=require("fs")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},1808:e=>{e.exports=require("net")},6005:e=>{e.exports=require("node:crypto")},1041:e=>{e.exports=require("node:url")},2037:e=>{e.exports=require("os")},1017:e=>{e.exports=require("path")},5477:e=>{e.exports=require("punycode")},2781:e=>{e.exports=require("stream")},4404:e=>{e.exports=require("tls")},7310:e=>{e.exports=require("url")},3837:e=>{e.exports=require("util")},9796:e=>{e.exports=require("zlib")},7285:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>v,patchFetch:()=>q,requestAsyncStorage:()=>y,routeModule:()=>b,serverHooks:()=>k,staticGenerationAsyncStorage:()=>g});var n={};t.r(n),t.d(n,{GET:()=>d,OPTIONS:()=>m,POST:()=>h});var s=t(5820),i=t(3944),o=t(765),a=t(643),l=t(2458),c=t(7568),p=t(8895),u=t(279);let d=async(e,{params:r})=>{try{let e=await u.Z.seller.findUnique({where:{username:r.username},include:{blink:!0}});if(!e||!e.blinkCreated||!e.blink)return Response.json({message:"User not found"},{headers:a.jS});let t={icon:e.blink.icon,title:e.blink.title,label:e.blink.label,description:e.blink.description,links:{actions:[{href:`/api/actions/${r.username}?navigate=products`,label:"Checkout to products"},{href:`/api/actions/${r.username}?navigate=orders`,label:"Check your orders"}]}};return Response.json(t,{headers:a.jS})}catch(e){return console.error("Error in GET request:",e),Response.json({message:"An error occurred while processing your request"},{headers:a.jS})}},m=d,h=async(e,{params:r})=>{try{let t,n;let s=new URL(e.url).searchParams.get("navigate");if(!s)return Response.json({message:"Navigate parameter is required"},{headers:a.jS});let i=await u.Z.seller.findUnique({where:{username:r.username},include:{blink:!0}});if(!i||!i.blinkCreated||!i.blink)return Response.json({message:"User not found"},{headers:a.jS});let o=await e.json();try{t=new c.PublicKey(o.account)}catch{return Response.json({message:"Invalid public key"},{headers:a.jS})}let d=await u.Z.product.findMany({where:{sellerId:i.walletAddress}}),m=await u.Z.order.findMany({where:{buyerWallet:o.account.toBase58(),orderstatus:"PROCESSING"},include:{product:!0}});if("products"===s)n=0===d.length?{type:"inline",action:{type:"completed",icon:"https://imgs.search.brave.com/mTigptQqts4F_6klqySaDOFw3rN35C_WULPGgqdB1Jg/rs:fit:860:0:0:0/g:ce/aHR0cHM6Ly9tZWRp/YS5nZXR0eWltYWdl/cy5jb20vaWQvMTMy/NjE5NjkyMS9waG90/by9vcGVuZWQtZW1w/dHktY2FyZGJvYXJk/LWJveC1vbi1ncmVl/bi5qcGc_cz02MTJ4/NjEyJnc9MCZrPTIw/JmM9d1k3eUpiZjFB/WDhuLXNMb2lpRHNI/c1pfS2RBRXpGdW40/RWpoczJnQXZhWT0",title:"Products Empty",description:"This Seller is not selling anything...",label:"Nothing to show here"}}:{type:"inline",action:{icon:i.blink.icon,description:i.blink.description,label:i.blink.label,title:i.blink.title,type:"action",links:{actions:[{href:`/api/actions/${r.username}/product/{productId}`,label:"Select Product",parameters:[{type:"select",name:"productId",label:"Select the product",options:d.map(e=>({label:e.name,value:e.id}))}]}]}}};else{if("orders"!==s)return Response.json({message:"Invalid navigate parameter"},{headers:a.jS});n=0===m.length?{type:"inline",action:{type:"completed",icon:"https://imgs.search.brave.com/mTigptQqts4F_6klqySaDOFw3rN35C_WULPGgqdB1Jg/rs:fit:860:0:0:0/g:ce/aHR0cHM6Ly9tZWRp/YS5nZXR0eWltYWdl/cy5jb20vaWQvMTMy/NjE5NjkyMS9waG90/by9vcGVuZWQtZW1w/dHktY2FyZGJvYXJk/LWJveC1vbi1ncmVl/bi5qcGc_cz02MTJ4/NjEyJnc9MCZrPTIw/JmM9d1k3eUpiZjFB/WDhuLXNMb2lpRHNI/c1pfS2RBRXpGdW40/RWpoczJnQXZhWT0",title:"You don't have any orders",description:"Please buy from someone's inventory to check orders",label:"Nothing to show here"}}:{type:"inline",action:{icon:i.blink.icon,description:"Orders with only processing status can be viewed here and can be cancelled",label:"You can check your processing orders and cancel them",title:"Check out your orders",type:"action",links:{actions:[{href:`/api/actions/${r.username}/orders/{orderid}`,label:"Select Order",parameters:[{type:"select",name:"orderid",label:"Select orders",options:m.map(e=>({label:e.product.name,value:e.id}))}]}]}}}}let h=(0,p.B)(),b=new c.Transaction;b.add(c.ComputeBudgetProgram.setComputeUnitPrice({microLamports:5}),new c.TransactionInstruction({programId:new c.PublicKey(a.jI),keys:[],data:Buffer.from(s,"utf-8")})),b.feePayer=t,b.recentBlockhash=(await h.getLatestBlockhash()).blockhash;let y=await (0,l.p)({fields:{transaction:b,message:"All good",links:{next:n}}});return Response.json(y,{headers:a.jS})}catch(e){return console.error("Error in POST request:",e),Response.json({message:"An error occurred while processing your request"},{headers:a.jS})}},b=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/actions/[username]/route",pathname:"/api/actions/[username]",filename:"route",bundlePath:"app/api/actions/[username]/route"},resolvedPagePath:"/workspaces/blink-e-commerce/src/app/api/actions/[username]/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:y,staticGenerationAsyncStorage:g,serverHooks:k}=b,v="/api/actions/[username]/route";function q(){return(0,o.patchFetch)({serverHooks:k,staticGenerationAsyncStorage:g})}},279:(e,r,t)=>{t.d(r,{Z:()=>s});var n=t(3524);let s=global.prismaGlobal??new n.PrismaClient},8895:(e,r,t)=>{t.d(r,{B:()=>s});var n=t(7568);let s=()=>new n.Connection(process.env.NEXT_PUBLIC_RPC_END_POINT||(0,n.clusterApiUrl)("devnet"),"confirmed")}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[544,744,458],()=>t(7285));module.exports=n})();