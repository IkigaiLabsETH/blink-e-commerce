"use strict";(()=>{var e={};e.id=166,e.ids=[166],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},524:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},2361:e=>{e.exports=require("events")},7147:e=>{e.exports=require("fs")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},1808:e=>{e.exports=require("net")},6005:e=>{e.exports=require("node:crypto")},1041:e=>{e.exports=require("node:url")},2037:e=>{e.exports=require("os")},1017:e=>{e.exports=require("path")},5477:e=>{e.exports=require("punycode")},2781:e=>{e.exports=require("stream")},4404:e=>{e.exports=require("tls")},7310:e=>{e.exports=require("url")},3837:e=>{e.exports=require("util")},9796:e=>{e.exports=require("zlib")},5801:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>g,patchFetch:()=>b,requestAsyncStorage:()=>h,routeModule:()=>x,serverHooks:()=>y,staticGenerationAsyncStorage:()=>q});var s={};t.r(s),t.d(s,{OPTIONS:()=>l,POST:()=>m});var a=t(5820),o=t(3944),i=t(765),n=t(643),p=t(2458),u=t(7568),d=t(8895),c=t(279);let l=()=>Response.json(null,{headers:n.jS}),m=async(e,{params:r})=>{try{let t;new URL(e.url),console.log("inside post with product id",e.url),console.log(r);let s=await e.json();console.log(s);try{t=new u.PublicKey(s.account)}catch(e){return Response.json({message:"Invalid public key"},{headers:n.jS})}let a=await c.Z.product.findUnique({where:{id:r.productid}});if(!a)return Response.json({message:"error while fetchingdata"},{headers:n.jS});let o=(0,d.B)(),i=new u.Transaction;i.add(u.ComputeBudgetProgram.setComputeUnitPrice({microLamports:5e3}),new u.TransactionInstruction({programId:new u.PublicKey(n.jI),keys:[],data:Buffer.from(JSON.stringify(r),"utf-8")})),i.feePayer=t,i.recentBlockhash=(await o.getLatestBlockhash()).blockhash;let l={type:"inline",action:{icon:a?.imageUrl||"https://avatars.githubusercontent.com/u/37742218?v=4",description:`${a?.description}, Availale stock ${a?.stock}`||"asdasdasd",label:a?.label||"asdasdasd",title:`${a?.title}`||"asdasdasdasdasd",type:"action",links:{actions:[{label:`Purchase product for ${a?.price||"1"} SOL`,href:`/api/actions/${r.username}/product/${r.productid}/purchase?name={name}&email={email}&address={address}&state={state}&zipcode={zipcode}&city={city}&amount=${a.price}`,parameters:[{name:"name",label:"enter your name",required:!0,patternDescription:"Ex: JOEY"},{name:"email",label:"enter your email",required:!0,patternDescription:"Ex: hello@xxx.com"},{name:"address",label:"enter your address",required:!0,patternDescription:"Ex: woodland steeet"},{name:"state",label:"enter your state",required:!0,patternDescription:"Ex: ohio"},{name:"city",label:"enter your city",required:!0,patternDescription:"Ex: Cleveland"},{name:"zipcode",label:"enter your zip code",required:!0,patternDescription:"Ex: 44129"}]}]}}},m=await (0,p.p)({fields:{transaction:i,message:"",links:{next:l}}});return Response.json(m,{headers:n.jS})}catch(e){return console.log(e),Response.json({message:"Error"},{headers:n.jS})}},x=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/actions/[username]/product/[productid]/route",pathname:"/api/actions/[username]/product/[productid]",filename:"route",bundlePath:"app/api/actions/[username]/product/[productid]/route"},resolvedPagePath:"/workspaces/blink-e-commerce/src/app/api/actions/[username]/product/[productid]/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:h,staticGenerationAsyncStorage:q,serverHooks:y}=x,g="/api/actions/[username]/product/[productid]/route";function b(){return(0,i.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:q})}},279:(e,r,t)=>{t.d(r,{Z:()=>a});var s=t(3524);let a=global.prismaGlobal??new s.PrismaClient},8895:(e,r,t)=>{t.d(r,{B:()=>a});var s=t(7568);let a=()=>new s.Connection(process.env.NEXT_PUBLIC_RPC_END_POINT||(0,s.clusterApiUrl)("devnet"),"confirmed")}};var r=require("../../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[544,744,458],()=>t(5801));module.exports=s})();